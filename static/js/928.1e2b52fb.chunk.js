(self.webpackChunkdesd_react=self.webpackChunkdesd_react||[]).push([[928],{2422:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(2791);const o=(e,t)=>{const[n,o]=(0,r.useState)((()=>{if("undefined"===typeof window)return t;try{const n=window.sessionStorage.getItem(e);return n?JSON.parse(n):t}catch(n){return console.warn("Error reading sessionStorage key \u201c".concat(e,"\u201d:"),n),t}}));return[n,t=>{"undefined"==typeof window&&console.warn("Tried setting sessionStorage key \u201c".concat(e,"\u201d even though environment is not a client"));try{const r=t instanceof Function?t(n):t;window.sessionStorage.setItem(e,JSON.stringify(r)),o(r),window.dispatchEvent(new Event("local-storage"))}catch(r){console.warn("Error setting sessionStorage key \u201c".concat(e,"\u201d:"),r)}}]}},3928:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var r=n(2791);var o=n(8647),s=n.n(o);const c=e=>e.replace(/\d+/g,(e=>s()(e)));var i=n(7689),a=n(2422);const l=e=>{let{startCountdown:t,countdownPromise:n,setSpeechResultReceived:o,setRetryMessage:s,isPaused:l,setButtonActive:u}=e;const d=(0,i.s0)(),[h,g]=(0,a.X)("testWords",""),[w,f]=(0,a.X)("wordIndex",0),[v,m]=(0,a.X)("levelIndex",0),[p,S]=(0,a.X)("correct",0),[y,x]=(0,a.X)("wrong",0),[k,b]=(0,a.X)("wrongAboveCurrentLevel",0),[E,j]=(0,a.X)("frozenWrongAboveCurrentLevel",!1),[A,R]=(0,a.X)("isLastWord",!1),[N,C]=(0,a.X)("readingLevel",null),[M,z]=(0,r.useState)(h[v].level),[P,X]=(0,r.useState)(Object.keys(h[v].words)),[F,I]=(0,r.useState)(P[w]),T=h.length-1,q=Object.keys(h[T].words).length-1,O=(()=>{const e=(0,r.useRef)(null);(0,r.useEffect)((()=>{e.current||(e.current=new(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition),e.current.continuous=!1,e.current.lang="en-US",e.current.interimResults=!1,e.current.maxAlternatives=1)}),[]);const t=()=>new Promise(((t,n)=>{e.current?(e.current.onresult=e=>{const n=e.results[0][0].transcript;t(n)},e.current.onerror=e=>{n(e.error)},e.current.start()):n(new Error("SpeechRecognition not available"))})),n=()=>{e.current&&e.current.stop()};return(0,r.useMemo)((()=>({recognizeSpeech:t,stopSpeechRecognition:n})),[])})(),V=h.reduce(((e,t)=>e+Object.keys(t.words).length),0),W=(v*P.length+w)/V*100;let B;(0,r.useEffect)((()=>{z(h[v].level),X((e=>{const t=Object.keys(h[v].words);return I(t[w]),t}))}),[v,w,h]);const D=(0,r.useCallback)((()=>{h[v]&&p>=P.length/2&&(C(h[v].level),b(0),j(!0)),y>=P.length/2&&k>=P.length&&w>=P.length&&(g(h),d("/eidetic")),A&&d("/completed")}),[p,v,A,d,k,w,y,P,h,g,j,C,b]);return(0,r.useEffect)((()=>{D()}),[D]),(0,r.useEffect)((()=>{w>=q+1&&(v<h.length-1&&(m((e=>e+1)),j(!1),b(0)),S(0),x(0),f(0))}),[w,v,q,h,S,j,m,f,x,b]),(0,r.useEffect)((()=>{console.log("current word: ".concat(P[w]," word index: ").concat(w,", grade index: ").concat(v,", \n                    grade level: ").concat(M,", correct: ").concat(p,", wrong: ").concat(y,", \n                    wrong above grade level: ").concat(k,", reading level: ").concat(N,"\n                    is_paused: ").concat(l))}),[P,w,v,M,p,y,k,N,l]),[async()=>{O.stopSpeechRecognition(),u(!1),o(!1),s("");try{t(3);const e=O.recognizeSpeech(),[r]=await Promise.all([e,n]);o(!0),B=c(r).toLowerCase(),console.log("Speech result:",B)}catch(a){return void console.error("Speech recognition error:",a)}let e;e="clique"===F?"click"===B||"clique"===B:"know"===F?"no"===B||"know"===B:"could"===F?"could"===B||"couldn't"===B:"meadow"===F?"metal"===B||"meadow"===B:"glisten"===F?"listen"===B||"glisten"===B:"toughen"===F?"toughen"===B||"puffin"===B:"islet"===F?"eyelet"===B||"islet"===B:"leitmotif"===F?"leitmotiv"===B||"leitmotif"===B:B===F;const r=e?p+1:p,i=e?y:y+1;R(v===T&&w===q),S(r),x(i),b((t=>E||e?t:t+1)),f((e=>e+1)),h[v].words[F]=e},F,A,W]},u=(e,t)=>{const[n,o]=(0,r.useState)(null),s=(0,r.useRef)(null),[c,i]=(0,r.useState)(null);(0,r.useEffect)((()=>{n||(async()=>{console.log("Getting audio context...");const e=new(window.AudioContext||window.webkitAudioContext),t=e.createAnalyser();o(t);try{const n=await navigator.mediaDevices.getUserMedia({audio:!0});console.log("Got audio stream:",n),i(n),e.createMediaStreamSource(n).connect(t)}catch(n){console.error("Error getting audio stream:",n)}})()}),[n]),(0,r.useEffect)((()=>()=>{if(console.log("Cleaning up audio stream..."),c){c.getAudioTracks().forEach((e=>e.stop()))}}),[c]);const a=()=>{if(console.log("Drawing..."),!e.current||!n)return;const r=e.current.getContext("2d"),o=new Uint8Array(n.frequencyBinCount);n.getByteFrequencyData(o),r.clearRect(0,0,e.current.width,e.current.height);const c=Math.min(e.current.width,e.current.height)/2,i=e.current.width/2,l=e.current.height/2,u=o.length,d=2*Math.PI/u;for(let e=0;e<u;e+=5){const t=o[e]/1.5,n=4,s=e*d,a=i+Math.cos(s)*(c-t),u=l+Math.sin(s)*(c-t),h=i+Math.cos(s)*c,g=l+Math.sin(s)*c;r.beginPath(),r.lineWidth=n,r.strokeStyle="#FFC107",r.moveTo(a,u),r.lineTo(h,g),r.stroke()}r.font='256px "Delicious Handrawn"',r.fillStyle="black",r.textAlign="center",r.textBaseline="middle",r.fillText(t,i,l),s.current=requestAnimationFrame(a)};(0,r.useEffect)((()=>(s.current||(s.current=requestAnimationFrame(a)),()=>{s.current&&(cancelAnimationFrame(s.current),s.current=null)})),[a,t]);return{startVisualization:()=>{s.current||a()},stopVisualization:()=>{s.current&&(cancelAnimationFrame(s.current),s.current=null)}}};var d=n(184);const h=e=>{let{isActive:t,countdownValue:n,size:o}=e;const s=(0,r.useRef)(null),{startVisualization:c,stopVisualization:i}=u(s,n);return(0,r.useEffect)((()=>{t?c():i()}),[t,c,i]),(0,d.jsx)("canvas",{ref:s,width:o,height:o})},g=e=>{let{progress:t}=e;return(0,d.jsx)("div",{className:"progress-bar",children:(0,d.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(t,"%")}})})},w=()=>{const[e,t,n]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;const[t,n]=(0,r.useState)(null),[o,s]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(null===t)return;if(0===t)return void s(!0);const r=setInterval((()=>{n((e=>e>0?e-1:0))}),e);return()=>clearInterval(r)}),[t,e]),[t,e=>{n(e),s(!1)},()=>new Promise((t=>{o&&t();const n=setInterval((()=>{o&&(t(),clearInterval(n))}),e)}))]}(),[o,s]=(()=>{const[e,t]=(0,r.useState)(!1);return[e,async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});e&&(t(!0),e.getTracks().forEach((e=>e.stop())))}catch(e){console.error("Error getting microphone access:",e),alert("No microphone detected. Please connect a microphone to use this app.")}}]})(),[c,i]=(0,r.useState)(!1),[a,u]=(0,r.useState)(!1),[w,f]=(0,r.useState)(!1),[v,m]=(0,r.useState)(""),[p,S]=(0,r.useState)(!1),[y,x,k,b]=l({startCountdown:t,countdownPromise:n,setSpeechResultReceived:S,setRetryMessage:m,isPaused:w,setButtonActive:u});(0,r.useEffect)((()=>{s()}),[s]),(0,r.useEffect)((()=>{!c||e>0||(p||(f(!0),setTimeout((()=>{f(!1)}),1e3)),p?(u(!0),m("")):(m("We didn't quite catch that. Please try again."),u(!0)))}),[c,p,e]),(0,r.useEffect)((()=>{p&&u(!0)}),[p]);return(0,d.jsx)("div",{className:"centered-content",children:(0,d.jsxs)("div",{className:"decoding-page",children:[(0,d.jsxs)("div",{className:"decoding-content",children:[!w&&c&&!k&&a?(0,d.jsx)("div",{className:"button-container",children:(0,d.jsxs)("div",{children:[v&&(0,d.jsx)("p",{children:v}),(0,d.jsx)("button",{onClick:y,children:v?"Try Again":"Next Word"})]})}):null,!c&&(0,d.jsx)("div",{className:"button-container",children:(0,d.jsx)("div",{children:(0,d.jsx)("button",{onClick:async()=>{o||await s(),o&&(i(!0),y())},children:"Start"})})}),!a&&c&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:"custom-p",children:"Say this word: "}),(0,d.jsx)("h2",{className:"custom-h2",children:x}),(0,d.jsx)(h,{isActive:!0,countdownValue:e,size:"300"})]})]}),(0,d.jsx)(g,{progress:b})]})})}},8647:e=>{const t=["","one ","two ","three ","four ","five ","six ","seven ","eight ","nine ","ten ","eleven ","twelve ","thirteen ","fourteen ","fifteen ","sixteen ","seventeen ","eighteen ","nineteen "],n=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],r=/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/,o=e=>t[Number(e)],s=e=>n[e[0]]+" "+t[e[1]];e.exports=function(e){const t=Number(e);if(isNaN(t))return"";if(0===t)return"zero";const n=t.toString();if(n.length>9)throw new Error("overflow");const[,c,i,a,l,u]=("000000000"+n).substr(-9).match(r);let d="";return d+=0!=c?(o(c)||s(c))+"crore ":"",d+=0!=i?(o(i)||s(i))+"lakh ":"",d+=0!=a?(o(a)||s(a))+"thousand ":"",d+=0!=l?o(l)+"hundred ":"",d+=0!=u&&""!=d?"and ":"",d+=0!=u?o(u)||s(u):"",d.trim()}}}]);
//# sourceMappingURL=928.1e2b52fb.chunk.js.map